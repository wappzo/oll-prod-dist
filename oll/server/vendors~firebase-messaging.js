exports.ids=[2],exports.modules={"+T3u":function(module,exports,__webpack_require__){"use strict";__webpack_require__("SS46");var component=__webpack_require__("S+S0"),util=__webpack_require__("Jv5v"),tslib=__webpack_require__("Ae4Y"),idb=__webpack_require__("TFGm");function _interopDefaultLegacy(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var _a,MessageType,firebase__default=_interopDefaultLegacy(__webpack_require__("eq5/")),ERROR_MAP=((_a={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',_a["only-available-in-window"]="This method is available in a Window context.",_a["only-available-in-sw"]="This method is available in a service worker context.",_a["permission-default"]="The notification permission was not granted and dismissed instead.",_a["permission-blocked"]="The notification permission was not granted and blocked instead.",_a["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",_a["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",_a["token-subscribe-failed"]="A problem occurred while subscribing the user to FCM: {$errorInfo}",_a["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",_a["token-unsubscribe-failed"]="A problem occurred while unsubscribing the user from FCM: {$errorInfo}",_a["token-update-failed"]="A problem occurred while updating the user from FCM: {$errorInfo}",_a["token-update-no-token"]="FCM returned no token when updating the user to push.",_a["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",_a["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",_a["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",_a["invalid-vapid-key"]="The public VAPID key must be a string.",_a["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",_a),ERROR_FACTORY=new util.ErrorFactory("messaging","Messaging",ERROR_MAP),DEFAULT_VAPID_KEY="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4";function arrayToBase64(array){var uint8Array=new Uint8Array(array);return btoa(String.fromCharCode.apply(String,tslib.__spread(uint8Array))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function base64ToArray(base64String){for(var base64=(base64String+"=".repeat((4-base64String.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),rawData=atob(base64),outputArray=new Uint8Array(rawData.length),i=0;i<rawData.length;++i)outputArray[i]=rawData.charCodeAt(i);return outputArray}!function(MessageType){MessageType.PUSH_RECEIVED="push-received",MessageType.NOTIFICATION_CLICKED="notification-clicked"}(MessageType||(MessageType={}));function migrateOldDatabase(senderId){return tslib.__awaiter(this,void 0,void 0,(function(){var databases,tokenDetails,_this=this;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return"databases"in indexedDB?[4,indexedDB.databases()]:[3,2];case 1:if(databases=_a.sent(),!databases.map((function(db){return db.name})).includes("fcm_token_details_db"))return[2,null];_a.label=2;case 2:return tokenDetails=null,[4,idb.openDb("fcm_token_details_db",5,(function(db){return tslib.__awaiter(_this,void 0,void 0,(function(){var objectStore,value,oldDetails,_a;return tslib.__generator(this,(function(_b){switch(_b.label){case 0:return db.oldVersion<2?[2]:db.objectStoreNames.contains("fcm_token_object_Store")?[4,(objectStore=db.transaction.objectStore("fcm_token_object_Store")).index("fcmSenderId").get(senderId)]:[2];case 1:return value=_b.sent(),[4,objectStore.clear()];case 2:if(_b.sent(),!value)return[2];if(2===db.oldVersion){if(!(oldDetails=value).auth||!oldDetails.p256dh||!oldDetails.endpoint)return[2];tokenDetails={token:oldDetails.fcmToken,createTime:null!==(_a=oldDetails.createTime)&&void 0!==_a?_a:Date.now(),subscriptionOptions:{auth:oldDetails.auth,p256dh:oldDetails.p256dh,endpoint:oldDetails.endpoint,swScope:oldDetails.swScope,vapidKey:"string"==typeof oldDetails.vapidKey?oldDetails.vapidKey:arrayToBase64(oldDetails.vapidKey)}}}else(3===db.oldVersion||4===db.oldVersion)&&(tokenDetails={token:(oldDetails=value).fcmToken,createTime:oldDetails.createTime,subscriptionOptions:{auth:arrayToBase64(oldDetails.auth),p256dh:arrayToBase64(oldDetails.p256dh),endpoint:oldDetails.endpoint,swScope:oldDetails.swScope,vapidKey:arrayToBase64(oldDetails.vapidKey)}});return[2]}}))}))}))];case 3:return _a.sent().close(),[4,idb.deleteDb("fcm_token_details_db")];case 4:return _a.sent(),[4,idb.deleteDb("fcm_vapid_details_db")];case 5:return _a.sent(),[4,idb.deleteDb("undefined")];case 6:return _a.sent(),[2,checkTokenDetails(tokenDetails)?tokenDetails:null]}}))}))}function checkTokenDetails(tokenDetails){if(!tokenDetails||!tokenDetails.subscriptionOptions)return!1;var subscriptionOptions=tokenDetails.subscriptionOptions;return"number"==typeof tokenDetails.createTime&&tokenDetails.createTime>0&&"string"==typeof tokenDetails.token&&tokenDetails.token.length>0&&"string"==typeof subscriptionOptions.auth&&subscriptionOptions.auth.length>0&&"string"==typeof subscriptionOptions.p256dh&&subscriptionOptions.p256dh.length>0&&"string"==typeof subscriptionOptions.endpoint&&subscriptionOptions.endpoint.length>0&&"string"==typeof subscriptionOptions.swScope&&subscriptionOptions.swScope.length>0&&"string"==typeof subscriptionOptions.vapidKey&&subscriptionOptions.vapidKey.length>0}var OBJECT_STORE_NAME="firebase-messaging-store",dbPromise=null;function getDbPromise(){return dbPromise||(dbPromise=idb.openDb("firebase-messaging-database",1,(function(upgradeDb){switch(upgradeDb.oldVersion){case 0:upgradeDb.createObjectStore(OBJECT_STORE_NAME)}}))),dbPromise}function dbGet(firebaseDependencies){return tslib.__awaiter(this,void 0,void 0,(function(){var key,tokenDetails,oldTokenDetails;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return key=getKey(firebaseDependencies),[4,getDbPromise()];case 1:return[4,_a.sent().transaction(OBJECT_STORE_NAME).objectStore(OBJECT_STORE_NAME).get(key)];case 2:return(tokenDetails=_a.sent())?[2,tokenDetails]:[3,3];case 3:return[4,migrateOldDatabase(firebaseDependencies.appConfig.senderId)];case 4:return(oldTokenDetails=_a.sent())?[4,dbSet(firebaseDependencies,oldTokenDetails)]:[3,6];case 5:return _a.sent(),[2,oldTokenDetails];case 6:return[2]}}))}))}function dbSet(firebaseDependencies,tokenDetails){return tslib.__awaiter(this,void 0,void 0,(function(){var key,db,tx;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return key=getKey(firebaseDependencies),[4,getDbPromise()];case 1:return db=_a.sent(),[4,(tx=db.transaction(OBJECT_STORE_NAME,"readwrite")).objectStore(OBJECT_STORE_NAME).put(tokenDetails,key)];case 2:return _a.sent(),[4,tx.complete];case 3:return _a.sent(),[2,tokenDetails]}}))}))}function dbRemove(firebaseDependencies){return tslib.__awaiter(this,void 0,void 0,(function(){var key,db,tx;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return key=getKey(firebaseDependencies),[4,getDbPromise()];case 1:return db=_a.sent(),[4,(tx=db.transaction(OBJECT_STORE_NAME,"readwrite")).objectStore(OBJECT_STORE_NAME).delete(key)];case 2:return _a.sent(),[4,tx.complete];case 3:return _a.sent(),[2]}}))}))}function getKey(_a){return _a.appConfig.appId}function requestGetToken(firebaseDependencies,subscriptionOptions){return tslib.__awaiter(this,void 0,void 0,(function(){var headers,body,subscribeOptions,responseData,err_1,message;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return[4,getHeaders(firebaseDependencies)];case 1:headers=_a.sent(),body=getBody(subscriptionOptions),subscribeOptions={method:"POST",headers:headers,body:JSON.stringify(body)},_a.label=2;case 2:return _a.trys.push([2,5,,6]),[4,fetch(getEndpoint(firebaseDependencies.appConfig),subscribeOptions)];case 3:return[4,_a.sent().json()];case 4:return responseData=_a.sent(),[3,6];case 5:throw err_1=_a.sent(),ERROR_FACTORY.create("token-subscribe-failed",{errorInfo:err_1});case 6:if(responseData.error)throw message=responseData.error.message,ERROR_FACTORY.create("token-subscribe-failed",{errorInfo:message});if(!responseData.token)throw ERROR_FACTORY.create("token-subscribe-no-token");return[2,responseData.token]}}))}))}function requestUpdateToken(firebaseDependencies,tokenDetails){return tslib.__awaiter(this,void 0,void 0,(function(){var headers,body,updateOptions,responseData,err_2,message;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return[4,getHeaders(firebaseDependencies)];case 1:headers=_a.sent(),body=getBody(tokenDetails.subscriptionOptions),updateOptions={method:"PATCH",headers:headers,body:JSON.stringify(body)},_a.label=2;case 2:return _a.trys.push([2,5,,6]),[4,fetch(getEndpoint(firebaseDependencies.appConfig)+"/"+tokenDetails.token,updateOptions)];case 3:return[4,_a.sent().json()];case 4:return responseData=_a.sent(),[3,6];case 5:throw err_2=_a.sent(),ERROR_FACTORY.create("token-update-failed",{errorInfo:err_2});case 6:if(responseData.error)throw message=responseData.error.message,ERROR_FACTORY.create("token-update-failed",{errorInfo:message});if(!responseData.token)throw ERROR_FACTORY.create("token-update-no-token");return[2,responseData.token]}}))}))}function requestDeleteToken(firebaseDependencies,token){return tslib.__awaiter(this,void 0,void 0,(function(){var headers,unsubscribeOptions,responseData,message,err_3;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return[4,getHeaders(firebaseDependencies)];case 1:headers=_a.sent(),unsubscribeOptions={method:"DELETE",headers:headers},_a.label=2;case 2:return _a.trys.push([2,5,,6]),[4,fetch(getEndpoint(firebaseDependencies.appConfig)+"/"+token,unsubscribeOptions)];case 3:return[4,_a.sent().json()];case 4:if((responseData=_a.sent()).error)throw message=responseData.error.message,ERROR_FACTORY.create("token-unsubscribe-failed",{errorInfo:message});return[3,6];case 5:throw err_3=_a.sent(),ERROR_FACTORY.create("token-unsubscribe-failed",{errorInfo:err_3});case 6:return[2]}}))}))}function getEndpoint(_a){return"https://fcmregistrations.googleapis.com/v1/projects/"+_a.projectId+"/registrations"}function getHeaders(_a){var appConfig=_a.appConfig,installations=_a.installations;return tslib.__awaiter(this,void 0,void 0,(function(){var authToken;return tslib.__generator(this,(function(_b){switch(_b.label){case 0:return[4,installations.getToken()];case 1:return authToken=_b.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":appConfig.apiKey,"x-goog-firebase-installations-auth":"FIS "+authToken})]}}))}))}function getBody(_a){var p256dh=_a.p256dh,auth=_a.auth,endpoint=_a.endpoint,vapidKey=_a.vapidKey,body={web:{endpoint:endpoint,auth:auth,p256dh:p256dh}};return vapidKey!==DEFAULT_VAPID_KEY&&(body.web.applicationPubKey=vapidKey),body}function getToken(firebaseDependencies,swRegistration,vapidKey){return tslib.__awaiter(this,void 0,void 0,(function(){var pushSubscription,tokenDetails,subscriptionOptions,e_1;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:if("granted"!==Notification.permission)throw ERROR_FACTORY.create("permission-blocked");return[4,getPushSubscription(swRegistration,vapidKey)];case 1:return pushSubscription=_a.sent(),[4,dbGet(firebaseDependencies)];case 2:return tokenDetails=_a.sent(),subscriptionOptions={vapidKey:vapidKey,swScope:swRegistration.scope,endpoint:pushSubscription.endpoint,auth:arrayToBase64(pushSubscription.getKey("auth")),p256dh:arrayToBase64(pushSubscription.getKey("p256dh"))},tokenDetails?[3,3]:[2,getNewToken(firebaseDependencies,subscriptionOptions)];case 3:if(function isTokenValid(dbOptions,currentOptions){var isVapidKeyEqual=currentOptions.vapidKey===dbOptions.vapidKey,isEndpointEqual=currentOptions.endpoint===dbOptions.endpoint,isAuthEqual=currentOptions.auth===dbOptions.auth,isP256dhEqual=currentOptions.p256dh===dbOptions.p256dh;return isVapidKeyEqual&&isEndpointEqual&&isAuthEqual&&isP256dhEqual}(tokenDetails.subscriptionOptions,subscriptionOptions))return[3,8];_a.label=4;case 4:return _a.trys.push([4,6,,7]),[4,requestDeleteToken(firebaseDependencies,tokenDetails.token)];case 5:return _a.sent(),[3,7];case 6:return e_1=_a.sent(),console.warn(e_1),[3,7];case 7:return[2,getNewToken(firebaseDependencies,subscriptionOptions)];case 8:return Date.now()>=tokenDetails.createTime+6048e5?[2,updateToken({token:tokenDetails.token,createTime:Date.now(),subscriptionOptions:subscriptionOptions},firebaseDependencies,swRegistration)]:[2,tokenDetails.token];case 9:return[2]}}))}))}function deleteToken(firebaseDependencies,swRegistration){return tslib.__awaiter(this,void 0,void 0,(function(){var tokenDetails,pushSubscription;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return[4,dbGet(firebaseDependencies)];case 1:return(tokenDetails=_a.sent())?[4,requestDeleteToken(firebaseDependencies,tokenDetails.token)]:[3,4];case 2:return _a.sent(),[4,dbRemove(firebaseDependencies)];case 3:_a.sent(),_a.label=4;case 4:return[4,swRegistration.pushManager.getSubscription()];case 5:return(pushSubscription=_a.sent())?[2,pushSubscription.unsubscribe()]:[2,!0]}}))}))}function updateToken(tokenDetails,firebaseDependencies,swRegistration){return tslib.__awaiter(this,void 0,void 0,(function(){var updatedToken,updatedTokenDetails,e_2;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,requestUpdateToken(firebaseDependencies,tokenDetails)];case 1:return updatedToken=_a.sent(),updatedTokenDetails=tslib.__assign(tslib.__assign({},tokenDetails),{token:updatedToken,createTime:Date.now()}),[4,dbSet(firebaseDependencies,updatedTokenDetails)];case 2:return _a.sent(),[2,updatedToken];case 3:return e_2=_a.sent(),[4,deleteToken(firebaseDependencies,swRegistration)];case 4:throw _a.sent(),e_2;case 5:return[2]}}))}))}function getNewToken(firebaseDependencies,subscriptionOptions){return tslib.__awaiter(this,void 0,void 0,(function(){var token,tokenDetails;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return[4,requestGetToken(firebaseDependencies,subscriptionOptions)];case 1:return token=_a.sent(),tokenDetails={token:token,createTime:Date.now(),subscriptionOptions:subscriptionOptions},[4,dbSet(firebaseDependencies,tokenDetails)];case 2:return _a.sent(),[2,tokenDetails.token]}}))}))}function getPushSubscription(swRegistration,vapidKey){return tslib.__awaiter(this,void 0,void 0,(function(){var subscription;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return[4,swRegistration.pushManager.getSubscription()];case 1:return(subscription=_a.sent())?[2,subscription]:[2,swRegistration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:base64ToArray(vapidKey)})]}}))}))}function isConsoleMessage(data){return"object"==typeof data&&!!data&&"google.c.a.c_id"in data}var SwController=function(){function SwController(firebaseDependencies){var _this=this;this.firebaseDependencies=firebaseDependencies,this.isOnBackgroundMessageUsed=null,this.vapidKey=null,this.bgMessageHandler=null,self.addEventListener("push",(function(e){e.waitUntil(_this.onPush(e))})),self.addEventListener("pushsubscriptionchange",(function(e){e.waitUntil(_this.onSubChange(e))})),self.addEventListener("notificationclick",(function(e){e.waitUntil(_this.onNotificationClick(e))}))}return Object.defineProperty(SwController.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),SwController.prototype.setBackgroundMessageHandler=function(callback){if(this.isOnBackgroundMessageUsed=!1,!callback||"function"!=typeof callback)throw ERROR_FACTORY.create("invalid-bg-handler");this.bgMessageHandler=callback},SwController.prototype.onBackgroundMessage=function(nextOrObserver){var _this=this;return this.isOnBackgroundMessageUsed=!0,this.bgMessageHandler=nextOrObserver,function(){_this.bgMessageHandler=null}},SwController.prototype.getToken=function(){var _a,_b;return tslib.__awaiter(this,void 0,void 0,(function(){var tokenDetails;return tslib.__generator(this,(function(_c){switch(_c.label){case 0:return this.vapidKey?[3,2]:[4,dbGet(this.firebaseDependencies)];case 1:tokenDetails=_c.sent(),this.vapidKey=null!==(_b=null===(_a=null==tokenDetails?void 0:tokenDetails.subscriptionOptions)||void 0===_a?void 0:_a.vapidKey)&&void 0!==_b?_b:DEFAULT_VAPID_KEY,_c.label=2;case 2:return[2,getToken(this.firebaseDependencies,self.registration,this.vapidKey)]}}))}))},SwController.prototype.deleteToken=function(){return deleteToken(this.firebaseDependencies,self.registration)},SwController.prototype.requestPermission=function(){throw ERROR_FACTORY.create("only-available-in-window")},SwController.prototype.usePublicVapidKey=function(vapidKey){if(null!==this.vapidKey)throw ERROR_FACTORY.create("use-vapid-key-after-get-token");if("string"!=typeof vapidKey||0===vapidKey.length)throw ERROR_FACTORY.create("invalid-vapid-key");this.vapidKey=vapidKey},SwController.prototype.useServiceWorker=function(){throw ERROR_FACTORY.create("only-available-in-window")},SwController.prototype.onMessage=function(){throw ERROR_FACTORY.create("only-available-in-window")},SwController.prototype.onTokenRefresh=function(){throw ERROR_FACTORY.create("only-available-in-window")},SwController.prototype.onPush=function(event){return tslib.__awaiter(this,void 0,void 0,(function(){var internalPayload,clientList,isNotificationShown,payload;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return(internalPayload=function getMessagePayloadInternal(_a){var data=_a.data;if(!data)return null;try{return data.json()}catch(err){return null}}(event))?[4,getClientList()]:(console.debug("FirebaseMessaging: failed to get parsed MessagePayload from the PushEvent. Skip handling the push."),[2]);case 1:return function hasVisibleClients(clientList){return clientList.some((function(client){return"visible"===client.visibilityState&&!client.url.startsWith("chrome-extension://")}))}(clientList=_a.sent())?[2,sendMessagePayloadInternalToWindows(clientList,internalPayload)]:(isNotificationShown=!1,internalPayload.notification?[4,showNotification(wrapInternalPayload(internalPayload))]:[3,3]);case 2:_a.sent(),isNotificationShown=!0,_a.label=3;case 3:return!0===isNotificationShown&&!1===this.isOnBackgroundMessageUsed||this.bgMessageHandler&&(payload=function externalizePayload(internalPayload){var payload={from:internalPayload.from,collapseKey:internalPayload.collapse_key};return function propagateNotificationPayload(payload,messagePayloadInternal){if(!messagePayloadInternal.notification)return;payload.notification={};var title=messagePayloadInternal.notification.title;title&&(payload.notification.title=title);var body=messagePayloadInternal.notification.body;body&&(payload.notification.body=body);var image=messagePayloadInternal.notification.image;image&&(payload.notification.image=image)}(payload,internalPayload),function propagateDataPayload(payload,messagePayloadInternal){if(!messagePayloadInternal.data)return;payload.data=messagePayloadInternal.data}(payload,internalPayload),function propagateFcmOptions(payload,messagePayloadInternal){if(!messagePayloadInternal.fcmOptions)return;payload.fcmOptions={};var link=messagePayloadInternal.fcmOptions.link;link&&(payload.fcmOptions.link=link);var analyticsLabel=messagePayloadInternal.fcmOptions.analytics_label;analyticsLabel&&(payload.fcmOptions.analyticsLabel=analyticsLabel)}(payload,internalPayload),payload}(internalPayload),"function"==typeof this.bgMessageHandler?this.bgMessageHandler(payload):this.bgMessageHandler.next(payload)),[2]}}))}))},SwController.prototype.onSubChange=function(event){var _a,_b;return tslib.__awaiter(this,void 0,void 0,(function(){var tokenDetails;return tslib.__generator(this,(function(_c){switch(_c.label){case 0:return event.newSubscription?[3,2]:[4,deleteToken(this.firebaseDependencies,self.registration)];case 1:return _c.sent(),[2];case 2:return[4,dbGet(this.firebaseDependencies)];case 3:return tokenDetails=_c.sent(),[4,deleteToken(this.firebaseDependencies,self.registration)];case 4:return _c.sent(),[4,getToken(this.firebaseDependencies,self.registration,null!==(_b=null===(_a=null==tokenDetails?void 0:tokenDetails.subscriptionOptions)||void 0===_a?void 0:_a.vapidKey)&&void 0!==_b?_b:DEFAULT_VAPID_KEY)];case 5:return _c.sent(),[2]}}))}))},SwController.prototype.onNotificationClick=function(event){var _a,_b;return tslib.__awaiter(this,void 0,void 0,(function(){var internalPayload,link,url,originUrl,client;return tslib.__generator(this,(function(_c){switch(_c.label){case 0:return(internalPayload=null===(_b=null===(_a=event.notification)||void 0===_a?void 0:_a.data)||void 0===_b?void 0:_b.FCM_MSG)?event.action?[2]:(event.stopImmediatePropagation(),event.notification.close(),(link=function getLink(payload){var _a,_b,_c,link=null!==(_b=null===(_a=payload.fcmOptions)||void 0===_a?void 0:_a.link)&&void 0!==_b?_b:null===(_c=payload.notification)||void 0===_c?void 0:_c.click_action;if(link)return link;return isConsoleMessage(payload.data)?self.location.origin:null}(internalPayload))?(url=new URL(link,self.location.href),originUrl=new URL(self.location.origin),url.host!==originUrl.host?[2]:[4,getWindowClient(url)]):[2]):[2];case 1:return(client=_c.sent())?[3,4]:[4,self.clients.openWindow(link)];case 2:return client=_c.sent(),[4,(ms=3e3,new Promise((function(resolve){setTimeout(resolve,ms)})))];case 3:return _c.sent(),[3,6];case 4:return[4,client.focus()];case 5:client=_c.sent(),_c.label=6;case 6:return client?(internalPayload.messageType=MessageType.NOTIFICATION_CLICKED,internalPayload.isFirebaseMessaging=!0,[2,client.postMessage(internalPayload)]):[2]}var ms}))}))},SwController}();function wrapInternalPayload(internalPayload){var _a,wrappedInternalPayload=tslib.__assign({},internalPayload.notification);return wrappedInternalPayload.data=((_a={}).FCM_MSG=internalPayload,_a),wrappedInternalPayload}function getWindowClient(url){return tslib.__awaiter(this,void 0,void 0,(function(){var clientList,clientList_1,clientList_1_1,client,clientUrl,e_1,_a;return tslib.__generator(this,(function(_b){switch(_b.label){case 0:return[4,getClientList()];case 1:clientList=_b.sent();try{for(clientList_1=tslib.__values(clientList),clientList_1_1=clientList_1.next();!clientList_1_1.done;clientList_1_1=clientList_1.next())if(client=clientList_1_1.value,clientUrl=new URL(client.url,self.location.href),url.host===clientUrl.host)return[2,client]}catch(e_1_1){e_1={error:e_1_1}}finally{try{clientList_1_1&&!clientList_1_1.done&&(_a=clientList_1.return)&&_a.call(clientList_1)}finally{if(e_1)throw e_1.error}}return[2,null]}}))}))}function sendMessagePayloadInternalToWindows(clientList,internalPayload){var e_2,_a;internalPayload.isFirebaseMessaging=!0,internalPayload.messageType=MessageType.PUSH_RECEIVED;try{for(var clientList_2=tslib.__values(clientList),clientList_2_1=clientList_2.next();!clientList_2_1.done;clientList_2_1=clientList_2.next()){clientList_2_1.value.postMessage(internalPayload)}}catch(e_2_1){e_2={error:e_2_1}}finally{try{clientList_2_1&&!clientList_2_1.done&&(_a=clientList_2.return)&&_a.call(clientList_2)}finally{if(e_2)throw e_2.error}}}function getClientList(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function showNotification(notificationPayloadInternal){var _a,actions=notificationPayloadInternal.actions,maxActions=Notification.maxActions;return actions&&maxActions&&actions.length>maxActions&&console.warn("This browser only supports "+maxActions+" actions. The remaining actions will not be displayed."),self.registration.showNotification(null!==(_a=notificationPayloadInternal.title)&&void 0!==_a?_a:"",notificationPayloadInternal)}var WindowController=function(){function WindowController(firebaseDependencies){var _this=this;this.firebaseDependencies=firebaseDependencies,this.vapidKey=null,this.onMessageCallback=null,navigator.serviceWorker.addEventListener("message",(function(e){return _this.messageEventListener(e)}))}return Object.defineProperty(WindowController.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),WindowController.prototype.messageEventListener=function(event){return tslib.__awaiter(this,void 0,void 0,(function(){var internalPayload,dataPayload;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return(internalPayload=event.data).isFirebaseMessaging?(this.onMessageCallback&&internalPayload.messageType===MessageType.PUSH_RECEIVED&&("function"==typeof this.onMessageCallback?this.onMessageCallback(function stripInternalFields(internalPayload){return delete internalPayload.messageType,delete internalPayload.isFirebaseMessaging,internalPayload}(Object.assign({},internalPayload))):this.onMessageCallback.next(Object.assign({},internalPayload))),isConsoleMessage(dataPayload=internalPayload.data)&&"1"===dataPayload["google.c.a.e"]?[4,this.logEvent(internalPayload.messageType,dataPayload)]:[3,2]):[2];case 1:_a.sent(),_a.label=2;case 2:return[2]}}))}))},WindowController.prototype.getVapidKey=function(){return this.vapidKey},WindowController.prototype.getSwReg=function(){return this.swRegistration},WindowController.prototype.getToken=function(options){return tslib.__awaiter(this,void 0,void 0,(function(){return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return"default"!==Notification.permission?[3,2]:[4,Notification.requestPermission()];case 1:_a.sent(),_a.label=2;case 2:if("granted"!==Notification.permission)throw ERROR_FACTORY.create("permission-blocked");return[4,this.updateVapidKey(null==options?void 0:options.vapidKey)];case 3:return _a.sent(),[4,this.updateSwReg(null==options?void 0:options.serviceWorkerRegistration)];case 4:return _a.sent(),[2,getToken(this.firebaseDependencies,this.swRegistration,this.vapidKey)]}}))}))},WindowController.prototype.updateVapidKey=function(vapidKey){return tslib.__awaiter(this,void 0,void 0,(function(){return tslib.__generator(this,(function(_a){return vapidKey?this.vapidKey=vapidKey:this.vapidKey||(this.vapidKey=DEFAULT_VAPID_KEY),[2]}))}))},WindowController.prototype.updateSwReg=function(swRegistration){return tslib.__awaiter(this,void 0,void 0,(function(){return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return swRegistration||this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:_a.sent(),_a.label=2;case 2:if(!swRegistration&&this.swRegistration)return[2];if(!(swRegistration instanceof ServiceWorkerRegistration))throw ERROR_FACTORY.create("invalid-sw-registration");return this.swRegistration=swRegistration,[2]}}))}))},WindowController.prototype.registerDefaultSw=function(){return tslib.__awaiter(this,void 0,void 0,(function(){var _a,e_1;return tslib.__generator(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,2,,3]),_a=this,[4,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"})];case 1:return _a.swRegistration=_b.sent(),this.swRegistration.update().catch((function(){})),[3,3];case 2:throw e_1=_b.sent(),ERROR_FACTORY.create("failed-service-worker-registration",{browserErrorMessage:e_1.message});case 3:return[2]}}))}))},WindowController.prototype.deleteToken=function(){return tslib.__awaiter(this,void 0,void 0,(function(){return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:_a.sent(),_a.label=2;case 2:return[2,deleteToken(this.firebaseDependencies,this.swRegistration)]}}))}))},WindowController.prototype.requestPermission=function(){return tslib.__awaiter(this,void 0,void 0,(function(){var permissionResult;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return"granted"===Notification.permission?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(permissionResult=_a.sent()))return[2];throw"denied"===permissionResult?ERROR_FACTORY.create("permission-blocked"):ERROR_FACTORY.create("permission-default")}}))}))},WindowController.prototype.usePublicVapidKey=function(vapidKey){if(null!==this.vapidKey)throw ERROR_FACTORY.create("use-vapid-key-after-get-token");if("string"!=typeof vapidKey||0===vapidKey.length)throw ERROR_FACTORY.create("invalid-vapid-key");this.vapidKey=vapidKey},WindowController.prototype.useServiceWorker=function(swRegistration){if(!(swRegistration instanceof ServiceWorkerRegistration))throw ERROR_FACTORY.create("invalid-sw-registration");if(this.swRegistration)throw ERROR_FACTORY.create("use-sw-after-get-token");this.swRegistration=swRegistration},WindowController.prototype.onMessage=function(nextOrObserver){var _this=this;return this.onMessageCallback=nextOrObserver,function(){_this.onMessageCallback=null}},WindowController.prototype.setBackgroundMessageHandler=function(){throw ERROR_FACTORY.create("only-available-in-sw")},WindowController.prototype.onBackgroundMessage=function(){throw ERROR_FACTORY.create("only-available-in-sw")},WindowController.prototype.onTokenRefresh=function(){return function(){}},WindowController.prototype.logEvent=function(messageType,data){return tslib.__awaiter(this,void 0,void 0,(function(){var eventType;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return eventType=function getEventType(messageType){switch(messageType){case MessageType.NOTIFICATION_CLICKED:return"notification_open";case MessageType.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(messageType),[4,this.firebaseDependencies.analyticsProvider.get()];case 1:return _a.sent().logEvent(eventType,{message_id:data["google.c.a.c_id"],message_name:data["google.c.a.c_l"],message_time:data["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),[2]}}))}))},WindowController}();function getMissingValueError(valueName){return ERROR_FACTORY.create("missing-app-config-values",{valueName:valueName})}var NAMESPACE_EXPORTS={isSupported:isSupported};function isSupported(){return self&&"ServiceWorkerGlobalScope"in self?function isSWControllerSupported(){return"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}():function isWindowControllerSupported(){return"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}()}firebase__default.default.INTERNAL.registerComponent(new component.Component("messaging",(function factoryMethod(container){var app=container.getProvider("app").getImmediate(),firebaseDependencies={app:app,appConfig:function extractAppConfig(app){var e_1,_a;if(!app||!app.options)throw getMissingValueError("App Configuration Object");if(!app.name)throw getMissingValueError("App Name");var options=app.options;try{for(var configKeys_1=tslib.__values(["projectId","apiKey","appId","messagingSenderId"]),configKeys_1_1=configKeys_1.next();!configKeys_1_1.done;configKeys_1_1=configKeys_1.next()){var keyName=configKeys_1_1.value;if(!options[keyName])throw getMissingValueError(keyName)}}catch(e_1_1){e_1={error:e_1_1}}finally{try{configKeys_1_1&&!configKeys_1_1.done&&(_a=configKeys_1.return)&&_a.call(configKeys_1)}finally{if(e_1)throw e_1.error}}return{appName:app.name,projectId:options.projectId,apiKey:options.apiKey,appId:options.appId,senderId:options.messagingSenderId}}(app),installations:container.getProvider("installations").getImmediate(),analyticsProvider:container.getProvider("analytics-internal")};if(!isSupported())throw ERROR_FACTORY.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new SwController(firebaseDependencies):new WindowController(firebaseDependencies)}),"PUBLIC").setServiceProps(NAMESPACE_EXPORTS))},Hkj9:function(module,exports,__webpack_require__){"use strict";__webpack_require__("+T3u")},SS46:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var firebase=__webpack_require__("eq5/"),component=__webpack_require__("S+S0"),tslib=__webpack_require__("Ae4Y"),util=__webpack_require__("Jv5v"),idb=__webpack_require__("TFGm");function _interopDefaultLegacy(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var _a,firebase__default=_interopDefaultLegacy(firebase),ERROR_DESCRIPTION_MAP=((_a={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',_a["not-registered"]="Firebase Installation is not registered.",_a["installation-not-found"]="Firebase Installation not found.",_a["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',_a["app-offline"]="Could not process request. Application offline.",_a["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",_a),ERROR_FACTORY=new util.ErrorFactory("installations","Installations",ERROR_DESCRIPTION_MAP);function isServerError(error){return error instanceof util.FirebaseError&&error.code.includes("request-failed")}function getInstallationsEndpoint(_a){return"https://firebaseinstallations.googleapis.com/v1/projects/"+_a.projectId+"/installations"}function extractAuthTokenInfoFromResponse(response){return{token:response.token,requestStatus:2,expiresIn:(responseExpiresIn=response.expiresIn,Number(responseExpiresIn.replace("s","000"))),creationTime:Date.now()};var responseExpiresIn}function getErrorFromResponse(requestName,response){return tslib.__awaiter(this,void 0,void 0,(function(){var responseJson,errorData;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return[4,response.json()];case 1:return responseJson=_a.sent(),errorData=responseJson.error,[2,ERROR_FACTORY.create("request-failed",{requestName:requestName,serverCode:errorData.code,serverMessage:errorData.message,serverStatus:errorData.status})]}}))}))}function getHeaders(_a){var apiKey=_a.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":apiKey})}function getHeadersWithAuth(appConfig,_a){var refreshToken=_a.refreshToken,headers=getHeaders(appConfig);return headers.append("Authorization",function getAuthorizationHeader(refreshToken){return"FIS_v2 "+refreshToken}(refreshToken)),headers}function retryIfServerError(fn){return tslib.__awaiter(this,void 0,void 0,(function(){var result;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return[4,fn()];case 1:return(result=_a.sent()).status>=500&&result.status<600?[2,fn()]:[2,result]}}))}))}function createInstallationRequest(appConfig,_a){var fid=_a.fid;return tslib.__awaiter(this,void 0,void 0,(function(){var endpoint,headers,body,request,response,responseValue;return tslib.__generator(this,(function(_b){switch(_b.label){case 0:return endpoint=getInstallationsEndpoint(appConfig),headers=getHeaders(appConfig),body={fid:fid,authVersion:"FIS_v2",appId:appConfig.appId,sdkVersion:"w:0.4.17"},request={method:"POST",headers:headers,body:JSON.stringify(body)},[4,retryIfServerError((function(){return fetch(endpoint,request)}))];case 1:return(response=_b.sent()).ok?[4,response.json()]:[3,3];case 2:return responseValue=_b.sent(),[2,{fid:responseValue.fid||fid,registrationStatus:2,refreshToken:responseValue.refreshToken,authToken:extractAuthTokenInfoFromResponse(responseValue.authToken)}];case 3:return[4,getErrorFromResponse("Create Installation",response)];case 4:throw _b.sent()}}))}))}function sleep(ms){return new Promise((function(resolve){setTimeout(resolve,ms)}))}var VALID_FID_PATTERN=/^[cdef][\w-]{21}$/;function generateFid(){try{var fidByteArray=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(fidByteArray),fidByteArray[0]=112+fidByteArray[0]%16;var fid=function encode(fidByteArray){return function bufferToBase64UrlSafe(array){return btoa(String.fromCharCode.apply(String,tslib.__spread(array))).replace(/\+/g,"-").replace(/\//g,"_")}(fidByteArray).substr(0,22)}(fidByteArray);return VALID_FID_PATTERN.test(fid)?fid:""}catch(_a){return""}}function getKey(appConfig){return appConfig.appName+"!"+appConfig.appId}var fidChangeCallbacks=new Map;function fidChanged(appConfig,fid){var key=getKey(appConfig);callFidChangeCallbacks(key,fid),function broadcastFidChange(key,fid){var channel=getBroadcastChannel();channel&&channel.postMessage({key:key,fid:fid});closeBroadcastChannel()}(key,fid)}function callFidChangeCallbacks(key,fid){var e_1,_a,callbacks=fidChangeCallbacks.get(key);if(callbacks)try{for(var callbacks_1=tslib.__values(callbacks),callbacks_1_1=callbacks_1.next();!callbacks_1_1.done;callbacks_1_1=callbacks_1.next()){(0,callbacks_1_1.value)(fid)}}catch(e_1_1){e_1={error:e_1_1}}finally{try{callbacks_1_1&&!callbacks_1_1.done&&(_a=callbacks_1.return)&&_a.call(callbacks_1)}finally{if(e_1)throw e_1.error}}}var broadcastChannel=null;function getBroadcastChannel(){return!broadcastChannel&&"BroadcastChannel"in self&&((broadcastChannel=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(e){callFidChangeCallbacks(e.data.key,e.data.fid)}),broadcastChannel}function closeBroadcastChannel(){0===fidChangeCallbacks.size&&broadcastChannel&&(broadcastChannel.close(),broadcastChannel=null)}var OBJECT_STORE_NAME="firebase-installations-store",dbPromise=null;function getDbPromise(){return dbPromise||(dbPromise=idb.openDb("firebase-installations-database",1,(function(upgradeDB){switch(upgradeDB.oldVersion){case 0:upgradeDB.createObjectStore(OBJECT_STORE_NAME)}}))),dbPromise}function set(appConfig,value){return tslib.__awaiter(this,void 0,void 0,(function(){var key,db,tx,objectStore,oldValue;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return key=getKey(appConfig),[4,getDbPromise()];case 1:return db=_a.sent(),tx=db.transaction(OBJECT_STORE_NAME,"readwrite"),[4,(objectStore=tx.objectStore(OBJECT_STORE_NAME)).get(key)];case 2:return oldValue=_a.sent(),[4,objectStore.put(value,key)];case 3:return _a.sent(),[4,tx.complete];case 4:return _a.sent(),oldValue&&oldValue.fid===value.fid||fidChanged(appConfig,value.fid),[2,value]}}))}))}function remove(appConfig){return tslib.__awaiter(this,void 0,void 0,(function(){var key,db,tx;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return key=getKey(appConfig),[4,getDbPromise()];case 1:return db=_a.sent(),[4,(tx=db.transaction(OBJECT_STORE_NAME,"readwrite")).objectStore(OBJECT_STORE_NAME).delete(key)];case 2:return _a.sent(),[4,tx.complete];case 3:return _a.sent(),[2]}}))}))}function update(appConfig,updateFn){return tslib.__awaiter(this,void 0,void 0,(function(){var key,db,tx,store,oldValue,newValue;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return key=getKey(appConfig),[4,getDbPromise()];case 1:return db=_a.sent(),tx=db.transaction(OBJECT_STORE_NAME,"readwrite"),[4,(store=tx.objectStore(OBJECT_STORE_NAME)).get(key)];case 2:return oldValue=_a.sent(),void 0!==(newValue=updateFn(oldValue))?[3,4]:[4,store.delete(key)];case 3:return _a.sent(),[3,6];case 4:return[4,store.put(newValue,key)];case 5:_a.sent(),_a.label=6;case 6:return[4,tx.complete];case 7:return _a.sent(),!newValue||oldValue&&oldValue.fid===newValue.fid||fidChanged(appConfig,newValue.fid),[2,newValue]}}))}))}function getInstallationEntry(appConfig){return tslib.__awaiter(this,void 0,void 0,(function(){var registrationPromise,installationEntry,_a;return tslib.__generator(this,(function(_b){switch(_b.label){case 0:return[4,update(appConfig,(function(oldEntry){var installationEntry=function updateOrCreateInstallationEntry(oldEntry){return clearTimedOutRequest(oldEntry||{fid:generateFid(),registrationStatus:0})}(oldEntry),entryWithPromise=function triggerRegistrationIfNecessary(appConfig,installationEntry){if(0===installationEntry.registrationStatus){if(!navigator.onLine){var registrationPromiseWithError=Promise.reject(ERROR_FACTORY.create("app-offline"));return{installationEntry:installationEntry,registrationPromise:registrationPromiseWithError}}var inProgressEntry={fid:installationEntry.fid,registrationStatus:1,registrationTime:Date.now()},registrationPromise=function registerInstallation(appConfig,installationEntry){return tslib.__awaiter(this,void 0,void 0,(function(){var registeredInstallationEntry,e_1;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,7]),[4,createInstallationRequest(appConfig,installationEntry)];case 1:return registeredInstallationEntry=_a.sent(),[2,set(appConfig,registeredInstallationEntry)];case 2:return isServerError(e_1=_a.sent())&&409===e_1.serverCode?[4,remove(appConfig)]:[3,4];case 3:return _a.sent(),[3,6];case 4:return[4,set(appConfig,{fid:installationEntry.fid,registrationStatus:0})];case 5:_a.sent(),_a.label=6;case 6:throw e_1;case 7:return[2]}}))}))}(appConfig,inProgressEntry);return{installationEntry:inProgressEntry,registrationPromise:registrationPromise}}return 1===installationEntry.registrationStatus?{installationEntry:installationEntry,registrationPromise:waitUntilFidRegistration(appConfig)}:{installationEntry:installationEntry}}(appConfig,installationEntry);return registrationPromise=entryWithPromise.registrationPromise,entryWithPromise.installationEntry}))];case 1:return""!==(installationEntry=_b.sent()).fid?[3,3]:(_a={},[4,registrationPromise]);case 2:return[2,(_a.installationEntry=_b.sent(),_a)];case 3:return[2,{installationEntry:installationEntry,registrationPromise:registrationPromise}]}}))}))}function waitUntilFidRegistration(appConfig){return tslib.__awaiter(this,void 0,void 0,(function(){var entry,_a,installationEntry,registrationPromise;return tslib.__generator(this,(function(_b){switch(_b.label){case 0:return[4,updateInstallationRequest(appConfig)];case 1:entry=_b.sent(),_b.label=2;case 2:return 1!==entry.registrationStatus?[3,5]:[4,sleep(100)];case 3:return _b.sent(),[4,updateInstallationRequest(appConfig)];case 4:return entry=_b.sent(),[3,2];case 5:return 0!==entry.registrationStatus?[3,7]:[4,getInstallationEntry(appConfig)];case 6:return _a=_b.sent(),installationEntry=_a.installationEntry,(registrationPromise=_a.registrationPromise)?[2,registrationPromise]:[2,installationEntry];case 7:return[2,entry]}}))}))}function updateInstallationRequest(appConfig){return update(appConfig,(function(oldEntry){if(!oldEntry)throw ERROR_FACTORY.create("installation-not-found");return clearTimedOutRequest(oldEntry)}))}function clearTimedOutRequest(entry){return function hasInstallationRequestTimedOut(installationEntry){return 1===installationEntry.registrationStatus&&installationEntry.registrationTime+1e4<Date.now()}(entry)?{fid:entry.fid,registrationStatus:0}:entry}function generateAuthTokenRequest(_a,installationEntry){var appConfig=_a.appConfig,platformLoggerProvider=_a.platformLoggerProvider;return tslib.__awaiter(this,void 0,void 0,(function(){var endpoint,headers,platformLogger,body,request,response,responseValue;return tslib.__generator(this,(function(_b){switch(_b.label){case 0:return endpoint=function getGenerateAuthTokenEndpoint(appConfig,_a){var fid=_a.fid;return getInstallationsEndpoint(appConfig)+"/"+fid+"/authTokens:generate"}(appConfig,installationEntry),headers=getHeadersWithAuth(appConfig,installationEntry),(platformLogger=platformLoggerProvider.getImmediate({optional:!0}))&&headers.append("x-firebase-client",platformLogger.getPlatformInfoString()),body={installation:{sdkVersion:"w:0.4.17"}},request={method:"POST",headers:headers,body:JSON.stringify(body)},[4,retryIfServerError((function(){return fetch(endpoint,request)}))];case 1:return(response=_b.sent()).ok?[4,response.json()]:[3,3];case 2:return responseValue=_b.sent(),[2,extractAuthTokenInfoFromResponse(responseValue)];case 3:return[4,getErrorFromResponse("Generate Auth Token",response)];case 4:throw _b.sent()}}))}))}function refreshAuthToken(dependencies,forceRefresh){return void 0===forceRefresh&&(forceRefresh=!1),tslib.__awaiter(this,void 0,void 0,(function(){var tokenPromise,entry,_a;return tslib.__generator(this,(function(_b){switch(_b.label){case 0:return[4,update(dependencies.appConfig,(function(oldEntry){if(!isEntryRegistered(oldEntry))throw ERROR_FACTORY.create("not-registered");var oldAuthToken=oldEntry.authToken;if(!forceRefresh&&function isAuthTokenValid(authToken){return 2===authToken.requestStatus&&!function isAuthTokenExpired(authToken){var now=Date.now();return now<authToken.creationTime||authToken.creationTime+authToken.expiresIn<now+36e5}(authToken)}(oldAuthToken))return oldEntry;if(1===oldAuthToken.requestStatus)return tokenPromise=function waitUntilAuthTokenRequest(dependencies,forceRefresh){return tslib.__awaiter(this,void 0,void 0,(function(){var entry,authToken;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return[4,updateAuthTokenRequest(dependencies.appConfig)];case 1:entry=_a.sent(),_a.label=2;case 2:return 1!==entry.authToken.requestStatus?[3,5]:[4,sleep(100)];case 3:return _a.sent(),[4,updateAuthTokenRequest(dependencies.appConfig)];case 4:return entry=_a.sent(),[3,2];case 5:return 0===(authToken=entry.authToken).requestStatus?[2,refreshAuthToken(dependencies,forceRefresh)]:[2,authToken]}}))}))}(dependencies,forceRefresh),oldEntry;if(!navigator.onLine)throw ERROR_FACTORY.create("app-offline");var inProgressEntry=function makeAuthTokenRequestInProgressEntry(oldEntry){var inProgressAuthToken={requestStatus:1,requestTime:Date.now()};return tslib.__assign(tslib.__assign({},oldEntry),{authToken:inProgressAuthToken})}(oldEntry);return tokenPromise=function fetchAuthTokenFromServer(dependencies,installationEntry){return tslib.__awaiter(this,void 0,void 0,(function(){var authToken,e_1,updatedInstallationEntry;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,8]),[4,generateAuthTokenRequest(dependencies,installationEntry)];case 1:return authToken=_a.sent(),updatedInstallationEntry=tslib.__assign(tslib.__assign({},installationEntry),{authToken:authToken}),[4,set(dependencies.appConfig,updatedInstallationEntry)];case 2:return _a.sent(),[2,authToken];case 3:return!isServerError(e_1=_a.sent())||401!==e_1.serverCode&&404!==e_1.serverCode?[3,5]:[4,remove(dependencies.appConfig)];case 4:return _a.sent(),[3,7];case 5:return updatedInstallationEntry=tslib.__assign(tslib.__assign({},installationEntry),{authToken:{requestStatus:0}}),[4,set(dependencies.appConfig,updatedInstallationEntry)];case 6:_a.sent(),_a.label=7;case 7:throw e_1;case 8:return[2]}}))}))}(dependencies,inProgressEntry),inProgressEntry}))];case 1:return entry=_b.sent(),tokenPromise?[4,tokenPromise]:[3,3];case 2:return _a=_b.sent(),[3,4];case 3:_a=entry.authToken,_b.label=4;case 4:return[2,_a]}}))}))}function updateAuthTokenRequest(appConfig){return update(appConfig,(function(oldEntry){if(!isEntryRegistered(oldEntry))throw ERROR_FACTORY.create("not-registered");return function hasAuthTokenRequestTimedOut(authToken){return 1===authToken.requestStatus&&authToken.requestTime+1e4<Date.now()}(oldEntry.authToken)?tslib.__assign(tslib.__assign({},oldEntry),{authToken:{requestStatus:0}}):oldEntry}))}function isEntryRegistered(installationEntry){return void 0!==installationEntry&&2===installationEntry.registrationStatus}function completeInstallationRegistration(appConfig){return tslib.__awaiter(this,void 0,void 0,(function(){var registrationPromise;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return[4,getInstallationEntry(appConfig)];case 1:return(registrationPromise=_a.sent().registrationPromise)?[4,registrationPromise]:[3,3];case 2:_a.sent(),_a.label=3;case 3:return[2]}}))}))}function deleteInstallationRequest(appConfig,installationEntry){return tslib.__awaiter(this,void 0,void 0,(function(){var endpoint,headers,request,response;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return endpoint=function getDeleteEndpoint(appConfig,_a){var fid=_a.fid;return getInstallationsEndpoint(appConfig)+"/"+fid}(appConfig,installationEntry),headers=getHeadersWithAuth(appConfig,installationEntry),request={method:"DELETE",headers:headers},[4,retryIfServerError((function(){return fetch(endpoint,request)}))];case 1:return(response=_a.sent()).ok?[3,3]:[4,getErrorFromResponse("Delete Installation",response)];case 2:throw _a.sent();case 3:return[2]}}))}))}function onIdChange(_a,callback){var appConfig=_a.appConfig;return function addCallback(appConfig,callback){getBroadcastChannel();var key=getKey(appConfig),callbackSet=fidChangeCallbacks.get(key);callbackSet||(callbackSet=new Set,fidChangeCallbacks.set(key,callbackSet)),callbackSet.add(callback)}(appConfig,callback),function(){!function removeCallback(appConfig,callback){var key=getKey(appConfig),callbackSet=fidChangeCallbacks.get(key);callbackSet&&(callbackSet.delete(callback),0===callbackSet.size&&fidChangeCallbacks.delete(key),closeBroadcastChannel())}(appConfig,callback)}}function getMissingValueError(valueName){return ERROR_FACTORY.create("missing-app-config-values",{valueName:valueName})}function registerInstallations(instance){instance.INTERNAL.registerComponent(new component.Component("installations",(function(container){var app=container.getProvider("app").getImmediate(),dependencies={appConfig:function extractAppConfig(app){var e_1,_a;if(!app||!app.options)throw getMissingValueError("App Configuration");if(!app.name)throw getMissingValueError("App Name");try{for(var configKeys_1=tslib.__values(["projectId","apiKey","appId"]),configKeys_1_1=configKeys_1.next();!configKeys_1_1.done;configKeys_1_1=configKeys_1.next()){var keyName=configKeys_1_1.value;if(!app.options[keyName])throw getMissingValueError(keyName)}}catch(e_1_1){e_1={error:e_1_1}}finally{try{configKeys_1_1&&!configKeys_1_1.done&&(_a=configKeys_1.return)&&_a.call(configKeys_1)}finally{if(e_1)throw e_1.error}}return{appName:app.name,projectId:app.options.projectId,apiKey:app.options.apiKey,appId:app.options.appId}}(app),platformLoggerProvider:container.getProvider("platform-logger")};return{app:app,getId:function(){return function getId(dependencies){return tslib.__awaiter(this,void 0,void 0,(function(){var _a,installationEntry,registrationPromise;return tslib.__generator(this,(function(_b){switch(_b.label){case 0:return[4,getInstallationEntry(dependencies.appConfig)];case 1:return _a=_b.sent(),installationEntry=_a.installationEntry,(registrationPromise=_a.registrationPromise)?registrationPromise.catch(console.error):refreshAuthToken(dependencies).catch(console.error),[2,installationEntry.fid]}}))}))}(dependencies)},getToken:function(forceRefresh){return function getToken(dependencies,forceRefresh){return void 0===forceRefresh&&(forceRefresh=!1),tslib.__awaiter(this,void 0,void 0,(function(){return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return[4,completeInstallationRegistration(dependencies.appConfig)];case 1:return _a.sent(),[4,refreshAuthToken(dependencies,forceRefresh)];case 2:return[2,_a.sent().token]}}))}))}(dependencies,forceRefresh)},delete:function(){return function deleteInstallation(dependencies){return tslib.__awaiter(this,void 0,void 0,(function(){var appConfig,entry;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return[4,update(appConfig=dependencies.appConfig,(function(oldEntry){if(!oldEntry||0!==oldEntry.registrationStatus)return oldEntry}))];case 1:if(!(entry=_a.sent()))return[3,6];if(1!==entry.registrationStatus)return[3,2];throw ERROR_FACTORY.create("delete-pending-registration");case 2:if(2!==entry.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw ERROR_FACTORY.create("app-offline");case 3:return[4,deleteInstallationRequest(appConfig,entry)];case 4:return _a.sent(),[4,remove(appConfig)];case 5:_a.sent(),_a.label=6;case 6:return[2]}}))}))}(dependencies)},onIdChange:function(callback){return onIdChange(dependencies,callback)}}}),"PUBLIC")),instance.registerVersion("@firebase/installations","0.4.17")}registerInstallations(firebase__default.default),exports.registerInstallations=registerInstallations},TFGm:function(module,exports,__webpack_require__){"undefined"!=typeof indexedDB?module.exports=__webpack_require__("nbvr"):module.exports={openDb:function(){return Promise.reject("IDB requires a browser environment")},deleteDb:function(){return Promise.reject("IDB requires a browser environment")}}},nbvr:function(module,exports,__webpack_require__){!function(exports){"use strict";function toArray(arr){return Array.prototype.slice.call(arr)}function promisifyRequest(request){return new Promise((function(resolve,reject){request.onsuccess=function(){resolve(request.result)},request.onerror=function(){reject(request.error)}}))}function promisifyRequestCall(obj,method,args){var request,p=new Promise((function(resolve,reject){promisifyRequest(request=obj[method].apply(obj,args)).then(resolve,reject)}));return p.request=request,p}function promisifyCursorRequestCall(obj,method,args){var p=promisifyRequestCall(obj,method,args);return p.then((function(value){if(value)return new Cursor(value,p.request)}))}function proxyProperties(ProxyClass,targetProp,properties){properties.forEach((function(prop){Object.defineProperty(ProxyClass.prototype,prop,{get:function(){return this[targetProp][prop]},set:function(val){this[targetProp][prop]=val}})}))}function proxyRequestMethods(ProxyClass,targetProp,Constructor,properties){properties.forEach((function(prop){prop in Constructor.prototype&&(ProxyClass.prototype[prop]=function(){return promisifyRequestCall(this[targetProp],prop,arguments)})}))}function proxyMethods(ProxyClass,targetProp,Constructor,properties){properties.forEach((function(prop){prop in Constructor.prototype&&(ProxyClass.prototype[prop]=function(){return this[targetProp][prop].apply(this[targetProp],arguments)})}))}function proxyCursorRequestMethods(ProxyClass,targetProp,Constructor,properties){properties.forEach((function(prop){prop in Constructor.prototype&&(ProxyClass.prototype[prop]=function(){return promisifyCursorRequestCall(this[targetProp],prop,arguments)})}))}function Index(index){this._index=index}function Cursor(cursor,request){this._cursor=cursor,this._request=request}function ObjectStore(store){this._store=store}function Transaction(idbTransaction){this._tx=idbTransaction,this.complete=new Promise((function(resolve,reject){idbTransaction.oncomplete=function(){resolve()},idbTransaction.onerror=function(){reject(idbTransaction.error)},idbTransaction.onabort=function(){reject(idbTransaction.error)}}))}function UpgradeDB(db,oldVersion,transaction){this._db=db,this.oldVersion=oldVersion,this.transaction=new Transaction(transaction)}function DB(db){this._db=db}proxyProperties(Index,"_index",["name","keyPath","multiEntry","unique"]),proxyRequestMethods(Index,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),proxyCursorRequestMethods(Index,"_index",IDBIndex,["openCursor","openKeyCursor"]),proxyProperties(Cursor,"_cursor",["direction","key","primaryKey","value"]),proxyRequestMethods(Cursor,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(methodName){methodName in IDBCursor.prototype&&(Cursor.prototype[methodName]=function(){var cursor=this,args=arguments;return Promise.resolve().then((function(){return cursor._cursor[methodName].apply(cursor._cursor,args),promisifyRequest(cursor._request).then((function(value){if(value)return new Cursor(value,cursor._request)}))}))})})),ObjectStore.prototype.createIndex=function(){return new Index(this._store.createIndex.apply(this._store,arguments))},ObjectStore.prototype.index=function(){return new Index(this._store.index.apply(this._store,arguments))},proxyProperties(ObjectStore,"_store",["name","keyPath","indexNames","autoIncrement"]),proxyRequestMethods(ObjectStore,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),proxyCursorRequestMethods(ObjectStore,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),proxyMethods(ObjectStore,"_store",IDBObjectStore,["deleteIndex"]),Transaction.prototype.objectStore=function(){return new ObjectStore(this._tx.objectStore.apply(this._tx,arguments))},proxyProperties(Transaction,"_tx",["objectStoreNames","mode"]),proxyMethods(Transaction,"_tx",IDBTransaction,["abort"]),UpgradeDB.prototype.createObjectStore=function(){return new ObjectStore(this._db.createObjectStore.apply(this._db,arguments))},proxyProperties(UpgradeDB,"_db",["name","version","objectStoreNames"]),proxyMethods(UpgradeDB,"_db",IDBDatabase,["deleteObjectStore","close"]),DB.prototype.transaction=function(){return new Transaction(this._db.transaction.apply(this._db,arguments))},proxyProperties(DB,"_db",["name","version","objectStoreNames"]),proxyMethods(DB,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(funcName){[ObjectStore,Index].forEach((function(Constructor){funcName in Constructor.prototype&&(Constructor.prototype[funcName.replace("open","iterate")]=function(){var args=toArray(arguments),callback=args[args.length-1],nativeObject=this._store||this._index,request=nativeObject[funcName].apply(nativeObject,args.slice(0,-1));request.onsuccess=function(){callback(request.result)}})}))})),[Index,ObjectStore].forEach((function(Constructor){Constructor.prototype.getAll||(Constructor.prototype.getAll=function(query,count){var instance=this,items=[];return new Promise((function(resolve){instance.iterateCursor(query,(function(cursor){cursor?(items.push(cursor.value),void 0===count||items.length!=count?cursor.continue():resolve(items)):resolve(items)}))}))})})),exports.openDb=function openDb(name,version,upgradeCallback){var p=promisifyRequestCall(indexedDB,"open",[name,version]),request=p.request;return request&&(request.onupgradeneeded=function(event){upgradeCallback&&upgradeCallback(new UpgradeDB(request.result,event.oldVersion,request.transaction))}),p.then((function(db){return new DB(db)}))},exports.deleteDb=function deleteDb(name){return promisifyRequestCall(indexedDB,"deleteDatabase",[name])},Object.defineProperty(exports,"__esModule",{value:!0})}(exports)}};